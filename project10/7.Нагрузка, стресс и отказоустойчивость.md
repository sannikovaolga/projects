# Тестирование БД

## Нагрузочное тестирование

**Нагрузочное тестирование базы данных** — это процесс тестирования базы данных на ее способность обрабатывать большие объемы данных и запросов в условиях высокой нагрузки.  
Цель такого тестирования — определить, какой уровень нагрузки может обрабатываться базой данных без потери производительности или стабильности работы системы. Для этого используются различные техники и инструменты, которые позволяют создавать симуляцию высокой нагрузки на базу данных и анализировать ее поведение в таких условиях. Результаты нагрузочного тестирования помогают оптимизировать работу базы данных и повысить ее производительность.

Необходимо проверить:  

- Время ответа при выполнении транзакций многочисленными удаленными пользователями  
- Время, затрачиваемое на выполнение отдельных интересующих запросов к БД  

Примеры:

- Многократное выполнение самых частых транзакций, для оценки общей производительности БД  
- Передача и прием больших файлов  
- Параллельный запуск многих других приложений на одном сервере  
- Интернет-магазин, который ожидает большой объем продаж в черную пятницу. Владелец приложения хочет убедиться в отсутствии проблем с производительностью при работе с ожидаемой нагрузкой. Чтобы оценить поведение программы как при нормальных, так и при пиковых нагрузках, будет проведено нагрузочное тестирование.

**Важными инструментами нагрузочного тестирования являются :**

**JMeter**: Этот инструмент также полезен для тестирования трафика в дополнение к стресс-тестированию. Он используется для оценки эффективности баз данных, веб-приложений и других программ.

**LoadRunner**: В дополнение к стресс-тестированию, нагрузочное тестирование также может быть выполнено с помощью LoadRunner. Базы данных, другие приложения, а также онлайн-приложения и мобильные приложения измеряются с помощью этого метода.

**BlazeMeter** используется для тестирования веб-приложений и мобильных приложений. Он известен своей масштабируемостью и простотой использования.

**Gatling:** инструмент тестирования трафика веб-приложений с открытым исходным кодом. Он известен своей гибкостью и простотой в использовании.

## Тестирование отказоустойчивости (failover testing)

Это вид тестирования, который позволяет оценить способность базы данных сохранять свою работоспособность в условиях неблагоприятных внешних факторов, таких как отключение серверов, сбои в сети и другие события. В ходе тестирования производятся сценарии сбоев и измеряется время, за которое система восстанавливает работу. Этот вид тестирования помогает определить уязвимости системы и улучшить ее отказоустойчивость.

Пример:  

- Объявление или внесение в массивы данных невозможных или ошибочных элементов 
- Проверка работы интернет магазина при падении сервера. Сервер будет выключаться в процессе оформления заказа. В результате, мы сможем увидеть, как система реагирует на подобную ситуацию, и определить, насколько успешно она восстанавливается после возникновения сбоя. 

## Стресс-тестирование

Направлено на поиск «точки отказа»("точка остнова") системы. С этой целью систему подвергают стрессу большим количеством одновременных запросов. Устойчивость подсистемы баз данных требует тщательного планирования, включая определение «точки отказа». Стресс-тестирование также известно как тестирование на усталость.

Пример: тестирование банковского приложения, которое ожидает большого объема сделок в конце финансового года. Владелец приложения хочет убедиться в отсутствии проблем с производительностью при работе с ожидаемой нагрузкой. Чтобы оценить поведение приложения при высоких требованиях, будет проведено стресс-тестирование.

В основном для стресс-тестирования применяются инструменты LoadRunner, JMeter, WinRunner.

## Отличия видов тестирование

|                       | Нагрузочное                                                                                                          | Тестирование на отказоустойчивость        | Стресс-тестирование                                                                                                                          |
|-----------------------|----------------------------------------------------------------------------------------------------------------------|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| Определение           | Допустимый уровень нагрузки                                                                                          | Способность восстанавливаться после сбоев | "точка отказа"/"точка остнова"                                                                                                                               |
| Цель                  | Повышение нагрузки на БД                                                                                             | Оценка сохранения работоспособности       | Предотвращение сбоев при увеличении количества запросов                                                                                      |
| Тип груза             | Максимальная нагрузка                                                                                                | До предельного               | Чрезмерный трафик                                                                                                                            |
| Предельная нагрузка   | Предельная нагрузка — это точка останова                                                                             | До предельной нагрузки                            | Выше точки останова                                                                                                                          |
| Основные показатели   | Скорость отклика, количество одновременных пользователей, пропускная способность и использование ресурсов            | Время восстановления, длительность сбоя, сохранение данных после сбоя, последовательность процедур восстановления   | Частота ошибок, критическая точка и максимальный пользовательский трафик                                                                     |
| Подход к тестированию | Выявление проблем с производительностью путем оценки поведения БД при выполнении ожидаемой рабочей нагрузки. | Проверка восстановления базы данных после возможного сбоя: работает ли БД и приложение корректно, восстановились ли данные, есть ли методология восстановления.                                          | Увеличивая нагрузку до тех пор, пока система не перестанет функционировать должным образом, можно определить критическую точку БД |

### Cпособы оптимизации (улучшения производительности) базы данных

1. **Оптимизация запросов**
В большинстве случаев проблемы с производительностью вызваны низкой производительностью SQL-запросов. 

2. **Создать оптимальные индексы**
При правильной индексации можно оптимизировать продолжительность выполнения запроса и повысить общую производительность базы данных. Индексы достигают этого, внедряя структуру данных, которая помогает поддерживать порядок и облегчает поиск информации; в основном, индексирование ускоряет процесс поиска данных и делает его более эффективным, тем самым экономя ваше время (и вашу систему) и усилия.

3. **Приобрести более мощный процессор**
Чем лучше  процессор, тем быстрее и эффективнее будет база данных.  

4. **Выделить больше памяти** Наличие большего объема памяти поможет повысить эффективность системы и общую производительность. 

5. **Дефрагментация данных**
 Дефрагментация диска позволит сгруппировать соответствующие данные, поэтому операции, связанные с вводом/выводом, будут выполняться быстрее, что напрямую повлияет на общую производительность запросов и базы данных.

6. **Типы дисков**
Для извлечения результатов даже одного запроса могут потребоваться миллионы операций ввода-вывода с диска, в зависимости от объема данных, к которым запрос должен получить доступ для обработки, и в зависимости от объема данных, возвращаемых из запроса. Таким образом, тип дисков на вашем сервере может сильно повлиять на производительность ваших SQL запросов. Работа с SSD-дисками может значительно повысить общую производительность базы данных и, в частности, производительность SQL-запросов.

7. **Версия базы данных**
Другим важным фактором производительности базы данных является версия MySQL, которую вы в настоящее время развертываете. Обновление последней версии базы данных может существенно повлиять на общую производительность базы данных. Возможно, что один запрос может работать лучше в старых версиях MySQL, чем в новых, но если посмотреть на общую производительность, новые версии, как правило, работают лучше.

